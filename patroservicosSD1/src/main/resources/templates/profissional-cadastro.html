<!-- <!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <!-- Bootstrap CSS 
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div th:fragment="conteudo">
  <div class="container-fluid py-4">
    <div class="row justify-content-center">
      <div class="col-lg-10 col-xl-8">
        
        <!-- Cabeçalho 
        <div class="d-flex justify-content-between align-items-center mb-4">
          <h2 class="h3 mb-0 text-primary">Cadastro de Profissional</h2>
          <button type="button" class="btn btn-outline-secondary" onclick="window.history.back()">
            <i class="bi bi-arrow-left"></i> Voltar
          </button>
        </div>

        <form id="formCadastroProfissional" enctype="multipart/form-data">
          
          <!-- Dados Pessoais / Profissional 
          <div class="card shadow-sm mb-4 border-0">
            <div class="card-header bg-primary text-white py-3">
              <h5 class="mb-0">
                <i class="bi bi-person-badge me-2"></i>Dados Pessoais / Profissional
              </h5>
            </div>
            <div class="card-body p-4">
              <div class="row g-3">
                <div class="col-md-6">
                  <label for="nome" class="form-label fw-semibold">Nome <span class="text-danger">*</span></label>
                  <input type="text" class="form-control" id="nome" required>
                  <div class="invalid-feedback">Por favor, informe o nome.</div>
                </div>
                <div class="col-md-3">
                  <label for="numero" class="form-label fw-semibold">Telefone</label>
                  <input type="tel" class="form-control" id="numero" placeholder="(00) 00000-0000">
                </div>
                <div class="col-md-3">
                  <label for="email" class="form-label fw-semibold">Email</label>
                  <input type="email" class="form-control" id="email" placeholder="exemplo@email.com">
                </div>
                <div class="col-md-4">
                  <label for="profissao" class="form-label fw-semibold">Profissão</label>
                  <input type="text" class="form-control" id="profissao" placeholder="Sua profissão">
                </div>
                <div class="col-md-4">
                  <label for="cidade" class="form-label fw-semibold">Cidade</label>
                  <input type="text" class="form-control" id="cidade" placeholder="Sua cidade">
                </div>
                <div class="col-md-4">
                  <label for="estado" class="form-label fw-semibold">Estado</label>
                  <select class="form-select" id="estado">
                    <option value="">Selecione...</option>
                    <option value="AC">Acre</option>
                    <option value="AL">Alagoas</option>
                    <option value="AP">Amapá</option>
                    <!-- Adicione todos os estados 
                  </select>
                </div>
                <div class="col-12">
                  <label for="descricao" class="form-label fw-semibold">Descrição Profissional</label>
                  <textarea class="form-control" id="descricao" rows="3" placeholder="Descreva sua experiência e habilidades..."></textarea>
                  <div class="form-text">Máximo de 500 caracteres.</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Documentos 
          <div class="card shadow-sm mb-4 border-0">
            <div class="card-header bg-warning text-dark py-3">
              <h5 class="mb-0">
                <i class="bi bi-files me-2"></i>Documentos
              </h5>
            </div>
            <div class="card-body p-4">
              <div class="row g-3">
                <div class="col-md-4">
                  <label for="cpf" class="form-label fw-semibold">CPF</label>
                  <input type="text" class="form-control" id="cpf" placeholder="000.000.000-00" data-mask="000.000.000-00">
                </div>
                <div class="col-md-4">
                  <label for="rg" class="form-label fw-semibold">RG</label>
                  <input type="text" class="form-control" id="rg" placeholder="00.000.000-0">
                </div>
                <div class="col-md-4">
                  <label for="fotoCpf" class="form-label fw-semibold">Foto CPF</label>
                  <input type="file" name="fotoCpf" accept="image/*" class="form-control">
                </div>
                <div class="col-md-4">
                  <label for="fotoRg" class="form-label fw-semibold">Foto RG</label>
                  <input type="file" name="fotoRg" accept="image/*" class="form-control">
                </div>
              </div>
            </div>
          </div>

          <!-- Perfil Profissional 
          <div class="card shadow-sm mb-4 border-0">
            <div class="card-header bg-success text-white py-3">
              <h5 class="mb-0">
                <i class="bi bi-award me-2"></i>Perfil Profissional
              </h5>
            </div>
            <div class="card-body p-4">
              <div class="row g-3">
                <div class="col-12">
                  <label for="fotos" class="form-label fw-semibold">Fotos do Portfólio</label>
                  <input type="file" name="portfolio" multiple accept="image/*" class="form-control">
                </div>
                <div class="col-12">
                  <label for="certificados" class="form-label fw-semibold">Certificados e Qualificações</label>
                  <textarea class="form-control" id="certificados" rows="2" placeholder="Descreva seus certificados separados por vírgula"></textarea>
                  <div class="form-text">Ex: Curso de Especialização, Certificação Profissional, etc.</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Dados de Acesso 
          <div class="card shadow-sm mb-4 border-0">
            <div class="card-header bg-info text-white py-3">
              <h5 class="mb-0">
                <i class="bi bi-shield-lock me-2"></i>Dados de Acesso
              </h5>
            </div>
            <div class="card-body p-4">
              <div class="row g-3">
                <div class="col-md-6">
                  <label for="login" class="form-label fw-semibold">Login <span class="text-danger">*</span></label>
                  <div class="input-group">
                    <span class="input-group-text bg-light">
                      <i class="bi bi-person-circle"></i>
                    </span>
                    <input type="text" class="form-control" id="login" placeholder="Escolha um nome de usuário" required>
                  </div>
                  <div class="form-text">Mínimo 3 caracteres. Será usado para acessar o sistema.</div>
                  <div class="invalid-feedback">Por favor, informe um login válido.</div>
                </div>
                <div class="col-md-6">
                  <label for="senha" class="form-label fw-semibold">Senha <span class="text-danger">*</span></label>
                  <div class="input-group">
                    <span class="input-group-text bg-light">
                      <i class="bi bi-key"></i>
                    </span>
                    <input type="password" class="form-control" id="senha" placeholder="Crie uma senha segura" required minlength="6">
                    <button class="btn btn-outline-secondary" type="button" onclick="toggleSenha()">
                      <i class="bi bi-eye"></i>
                    </button>
                  </div>
                  <div class="form-text">Mínimo 6 caracteres.</div>
                  <div class="invalid-feedback">A senha deve ter pelo menos 6 caracteres.</div>
                </div>
                <div class="col-12">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="concordoTermos" required>
                    <label class="form-check-label" for="concordoTermos">
                      Concordo com os <a href="#" class="text-decoration-none">Termos de Uso</a> e 
                      <a href="#" class="text-decoration-none">Política de Privacidade</a>
                    </label>
                    <div class="invalid-feedback">
                      Você deve concordar com os termos para continuar.
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Botões de Ação 
          <div class="d-flex gap-2 justify-content-end border-top pt-4">
            <button type="button" class="btn btn-outline-secondary" onclick="limparFormulario()">
              <i class="bi bi-eraser me-1"></i>Limpar
            </button>
            <button class="btn btn-primary" type="button" onclick="enviarCadastroUpload()">
              <i class="bi bi-check-lg me-1"></i>Enviar Cadastro
            </button>
          </div>

          <!-- Mensagens de Feedback 
          <div class="mt-3">
            <div id="erroCadastro" class="alert alert-danger d-none" role="alert"></div>
            <div id="resultadoCadastro" class="alert alert-success d-none" role="alert"></div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<div th:fragment="scripts">
  <!-- Bootstrap JS 
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Bootstrap Icons 
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <script src="/js/profissional-cadastro.js"></script>
  
  <script>
    // Validação do formulário
    (function() {
      'use strict';
      window.addEventListener('load', function() {
        var forms = document.getElementsByClassName('needs-validation');
        var validation = Array.prototype.filter.call(forms, function(form) {
          form.addEventListener('submit', function(event) {
            if (form.checkValidity() === false) {
              event.preventDefault();
              event.stopPropagation();
            }
            form.classList.add('was-validated');
          }, false);
        });
      }, false);
    })();

    function limparFormulario() {
      document.getElementById('formCadastroProfissional').reset();
      document.getElementById('formCadastroProfissional').classList.remove('was-validated');
      document.getElementById('erroCadastro').classList.add('d-none');
      document.getElementById('resultadoCadastro').classList.add('d-none');
    }

    function toggleSenha() {
      const senhaInput = document.getElementById('senha');
      const toggleIcon = document.querySelector('#senha ~ button i');
      
      if (senhaInput.type === 'password') {
        senhaInput.type = 'text';
        toggleIcon.className = 'bi bi-eye-slash';
      } else {
        senhaInput.type = 'password';
        toggleIcon.className = 'bi bi-eye';
      }
    }

    function enviarCadastroUpload() {
      const form = document.getElementById('formCadastroProfissional');
      const fd = new FormData();

      // monta o JSON "dados"
      const dados = {
        nome: document.getElementById('nome').value,
        numero: document.getElementById('numero').value,
        email: document.getElementById('email').value,
        profissao: document.getElementById('profissao').value,
        descricao: document.getElementById('descricao').value,
        cidade: document.getElementById('cidade').value,
        estado: document.getElementById('estado').value,
        cpf: document.getElementById('cpf').value,
        rg: document.getElementById('rg').value,
        certificados: document.getElementById('certificados').value,
        login: document.getElementById('login').value,
        senha: document.getElementById('senha').value
      };
      fd.append('dados', new Blob([JSON.stringify(dados)], { type: 'application/json' }));

      // arquivos
      const inpCpf = form.querySelector('input[name="fotoCpf"]');
      const inpRg = form.querySelector('input[name="fotoRg"]');
      const inpPortfolio = form.querySelector('input[name="portfolio"]');
      if (inpCpf?.files[0]) fd.append('fotoCpf', inpCpf.files[0]);
      if (inpRg?.files[0]) fd.append('fotoRg', inpRg.files[0]);
      if (inpPortfolio?.files?.length) {
        for (const f of inpPortfolio.files) fd.append('portfolio', f);
      }

      // envia
      fetch('/api/profissionais/cadastro-completo-upload', { method: 'POST', body: fd })
        .then(async resp => {
          const erroDiv = document.getElementById('erroCadastro');
          const okDiv = document.getElementById('resultadoCadastro');
          erroDiv.classList.add('d-none'); okDiv.classList.add('d-none');

          if (!resp.ok) {
            const err = await resp.json().catch(()=>({mensagem:'Erro no cadastro'}));
            erroDiv.textContent = err.mensagem || 'Erro no cadastro';
            erroDiv.classList.remove('d-none');
            return;
          }
          const r = await resp.json();
          okDiv.innerHTML = `Cadastro realizado! ID: <code>${r.profissionalId}</code>
            <div class="mt-2"><a class="btn btn-sm btn-success" href="/profissional/perfil-publico?id=${r.profissionalId}">Ver Perfil Público</a></div>`;
          okDiv.classList.remove('d-none');
          form.reset();
        })
        .catch(e => {
          const erroDiv = document.getElementById('erroCadastro');
          erroDiv.textContent = 'Erro ao realizar cadastro: ' + e.message;
          erroDiv.classList.remove('d-none');
        });
    }
  </script>
</div>
</body>
</html> -->
<!-- <!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login Cliente - Patro Serviços</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <style>
    .auth-container { min-height: 100vh; background: linear-gradient(135deg,#667eea 0%,#764ba2 100%); }
    .auth-card { background:#fff; border-radius:15px; box-shadow:0 10px 30px rgba(0,0,0,0.1); }
    .btn-primary { background:#667eea; border:none; padding:12px; }
    .btn-primary:hover { background:#5a6fd8; transform:translateY(-1px); }
    .form-control { padding:12px; border-radius:8px; }
    .switch-link { color:#667eea; text-decoration:none; font-weight:500; cursor:pointer; }
    .switch-link:hover { color:#764ba2; }
  </style>
</head>
<body>
  <div class="auth-container d-flex align-items-center justify-content-center py-5">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-6 col-lg-5">
          <div class="auth-card p-5" id="loginCard">
            <div class="text-center mb-4">
              <h3 class="fw-bold text-primary">Bem-vindo de volta</h3>
              <p class="text-muted">Entre na sua conta (Cliente)</p>
            </div>
            <form onsubmit="handleLogin(event)">
              <div class="mb-3">
                <label class="form-label">Login</label>
                <div class="input-group">
                  <span class="input-group-text bg-light"><i class="bi bi-person text-muted"></i></span>
                  <input type="text" class="form-control" id="loginLogin" placeholder="seu login" required>
                </div>
              </div>
              <div class="mb-4">
                <label class="form-label">Senha</label>
                <div class="input-group">
                  <span class="input-group-text bg-light"><i class="bi bi-lock text-muted"></i></span>
                  <input type="password" class="form-control" id="loginSenha" placeholder="Sua senha" required>
                </div>
              </div>
              <button type="submit" class="btn btn-primary w-100 py-2 mb-3"><i class="bi bi-box-arrow-in-right me-2"></i>Entrar</button>
            </form>
            <div class="text-center">
              <span class="text-muted">Não tem conta?</span>
              <span class="switch-link ms-1" onclick="showRegister()">Criar conta</span>
            </div>
          </div>
          <div class="auth-card p-5 d-none" id="registerCard">
            <div class="text-center mb-4">
              <h3 class="fw-bold text-primary">Criar Conta</h3>
              <p class="text-muted">Junte-se à nossa comunidade</p>
            </div>
            <form onsubmit="handleRegister(event)">
              <div class="mb-3">
                <label class="form-label">Nome Completo</label>
                <div class="input-group">
                  <span class="input-group-text bg-light"><i class="bi bi-person text-muted"></i></span>
                  <input type="text" class="form-control" id="regNome" placeholder="Seu nome completo" required>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label">Login</label>
                <div class="input-group">
                  <span class="input-group-text bg-light"><i class="bi bi-person text-muted"></i></span>
                  <input type="text" class="form-control" id="regLogin" placeholder="Crie seu login" required>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label">Email</label>
                <div class="input-group">
                  <span class="input-group-text bg-light"><i class="bi bi-envelope text-muted"></i></span>
                  <input type="email" class="form-control" id="regEmail" placeholder="seu@email.com" required>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label">Telefone</label>
                <div class="input-group">
                  <span class="input-group-text bg-light"><i class="bi bi-telephone text-muted"></i></span>
                  <input type="tel" class="form-control" id="regTelefone" placeholder="(00) 00000-0000" required>
                </div>
              </div>
              <div class="mb-4">
                <label class="form-label">Senha</label>
                <div class="input-group">
                  <span class="input-group-text bg-light"><i class="bi bi-lock text-muted"></i></span>
                  <input type="password" class="form-control" id="regSenha" placeholder="Mínimo 6 caracteres" minlength="6" required>
                </div>
              </div>
              <button type="submit" class="btn btn-primary w-100 py-2 mb-3"><i class="bi bi-person-plus me-2"></i>Criar Conta</button>
            </form>
            <div class="text-center">
              <span class="text-muted">Já tem conta?</span>
              <span class="switch-link ms-1" onclick="showLogin()">Fazer login</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    function showLogin(){loginCard.classList.remove('d-none');registerCard.classList.add('d-none');}
    function showRegister(){registerCard.classList.remove('d-none');loginCard.classList.add('d-none');}
    async function handleLogin(e){e.preventDefault();const login=loginLogin.value.trim();const senha=loginSenha.value;const btn=e.target.querySelector('button');const txt=btn.innerHTML;btn.innerHTML='<i class="bi bi-arrow-repeat spinner"></i> Entrando...';btn.disabled=true;try{const r=await fetch('/api/usuarios-clientes/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({login,senha})});if(!r.ok)throw new Error('Falha ao autenticar');const d=await r.json();if(d&&d.autenticado){sessionStorage.setItem('clienteLogin',d.login);if(d.clienteId)sessionStorage.setItem('clienteId',d.clienteId);if(d.usuarioId)sessionStorage.setItem('clienteUsuarioId',d.usuarioId);location.href='/';}else alert('Login inválido');}catch(err){console.error(err);alert('Erro no login');}finally{btn.innerHTML=txt;btn.disabled=false;}}
    async function handleRegister(e){e.preventDefault();const nome=regNome.value.trim();const login=regLogin.value.trim();const email=regEmail.value.trim();const telefone=regTelefone.value;const senha=regSenha.value;const numero=telefone.replace(/\D/g,'');const btn=e.target.querySelector('button');const txt=btn.innerHTML;btn.innerHTML='<i class="bi bi-arrow-repeat spinner"></i> Criando conta...';btn.disabled=true;try{const rc=await fetch('/api/clientes',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({nome,email,numero})});if(!rc.ok)throw new Error('Falha ao criar cliente');const cliente=await rc.json();const ru=await fetch('/api/usuarios-clientes',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({login,senha,clienteId:cliente.id})});if(!ru.ok)throw new Error('Falha ao criar usuário');const rl=await fetch('/api/usuarios-clientes/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({login,senha})});const ld=await rl.json();if(ld&&ld.autenticado){sessionStorage.setItem('clienteLogin',ld.login);if(ld.clienteId)sessionStorage.setItem('clienteId',ld.clienteId);if(ld.usuarioId)sessionStorage.setItem('clienteUsuarioId',ld.usuarioId);location.href='/';}else{alert('Conta criada. Faça login.');showLogin();}}catch(err){console.error(err);alert('Erro ao criar conta');}finally{btn.innerHTML=txt;btn.disabled=false;}}
    regTelefone.addEventListener('input',e=>{let v=e.target.value.replace(/\D/g,'');if(v.length<=10)v=v.replace(/(\d{2})(\d{4})(\d{0,4})/,'($1) $2-$3');else v=v.replace(/(\d{2})(\d{5})(\d{0,4})/,'($1) $2-$3');e.target.value=v;});
  </script>
</body>
</html> -->


<p>login cliente gestor</p>